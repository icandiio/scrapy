<map version="1.0.1">
<!-- To view this file, download free mind mapping software FreeMind from http://freemind.sourceforge.net -->
<node CREATED="1482239385877" ID="ID_928700666" MODIFIED="1482239408113" TEXT="scrapy">
<node CREATED="1482239392800" ID="ID_1089629777" MODIFIED="1482239596524" POSITION="right" TEXT="cmdline">
<node CREATED="1482239464589" ID="ID_1011747148" MODIFIED="1482239472499" TEXT="&#x914d;&#x7f6e;&#x5904;&#x7406;">
<node CREATED="1482240714498" ID="ID_1312237903" MODIFIED="1482240923372" TEXT="scrapy.util.project.get_project_settings -&gt; scrapy.cfg&#xff0c;&#x8bbe;&#x7f6e;&#x73af;&#x5883;&#x53d8;&#x91cf;&#xff0c;&#x6dfb;&#x52a0;&#x5de5;&#x7a0b;&#x76ee;&#x5f55;&#x5230;sys.path"/>
<node CREATED="1482240838566" ID="ID_1441119461" MODIFIED="1482240910008" TEXT="scrapy.util.project.inside_projct -&gt; &#x5bfc;&#x5165;settings&#x6a21;&#x5757;"/>
</node>
<node CREATED="1482239472848" ID="ID_911859772" MODIFIED="1490486192552" TEXT="&#x6267;&#x884c;ScrapyCommand">
<arrowlink DESTINATION="ID_1101773353" ENDARROW="Default" ENDINCLINATION="104;0;" ID="Arrow_ID_1737497281" STARTARROW="None" STARTINCLINATION="104;0;"/>
</node>
</node>
<node CREATED="1482239396888" ID="ID_1101773353" MODIFIED="1482239590284" POSITION="right" TEXT="ScrapyCommand">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1101773353" ENDARROW="Default" ENDINCLINATION="104;0;" ID="Arrow_ID_1737497281" SOURCE="ID_911859772" STARTARROW="None" STARTINCLINATION="104;0;"/>
<node CREATED="1482239820984" ID="ID_17974162" MODIFIED="1527144406339" TEXT="&#x547d;&#x4ee4;&#x6267;&#x884c;&#x4f53;&#x5c01;&#x88c5;&#xff0c;cmd.run()&#x6267;&#x884c;&#x547d;&#x4ee4;"/>
<node CREATED="1482239839563" ID="ID_400515794" MODIFIED="1527144719529" TEXT="crawl&#x547d;&#x4ee4;&#xff1a;&#x6267;&#x884c;crawl&#x4efb;&#x52a1;&#xff0c;&#x8c03;&#x7528;CrawlerProcess&#x7684;crawl&#x548c;start&#x65b9;&#x6cd5;">
<arrowlink DESTINATION="ID_1046668232" ENDARROW="Default" ENDINCLINATION="407;0;" ID="Arrow_ID_822278041" STARTARROW="None" STARTINCLINATION="407;0;"/>
</node>
</node>
<node CREATED="1482239409769" ID="ID_1046668232" MODIFIED="1527144719529" POSITION="right" TEXT="CrawlerProcess(CrawlerRunner)&#xff1a;&#x722c;&#x53d6;&#x8fdb;&#x7a0b;">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1046668232" ENDARROW="Default" ENDINCLINATION="407;0;" ID="Arrow_ID_822278041" SOURCE="ID_400515794" STARTARROW="None" STARTINCLINATION="407;0;"/>
<node CREATED="1482239892911" ID="ID_1832814899" MODIFIED="1527144694484" TEXT="&#x722c;&#x53d6;&#x4efb;&#x52a1;&#x8fd0;&#x884c;&#x8f7d;&#x4f53;&#xff0c;&#x7ba1;&#x7406;Crawler&#x5bf9;&#x8c61;"/>
<node CREATED="1482239944933" ID="ID_1073607921" MODIFIED="1482240018674" TEXT="&#x53ef;&#x63a7;&#x5236;&#x591a;&#x4e2a;Crawler&#x5bf9;&#x8c61;&#x6765;&#x540c;&#x65f6;&#x8fdb;&#x884c;&#x591a;&#x4e2a;&#x4e0d;&#x540c;&#x7684;&#x722c;&#x53d6;&#x4efb;&#x52a1;&#xff0c;&#x8c03;&#x7528;Crawler&#x5bf9;&#x8c61;&#x7684;crawl&#x65b9;&#x6cd5;"/>
<node CREATED="1490523836352" ID="ID_1105100538" MODIFIED="1490524353450" TEXT="members">
<node CREATED="1527145381314" ID="ID_1931723274" MODIFIED="1527145427603" TEXT="properties">
<node CREATED="1490523885048" ID="ID_1293195291" MODIFIED="1527145409524" TEXT="init">
<node CREATED="1490523909752" ID="ID_222807723" MODIFIED="1490523912084" TEXT="settings"/>
<node CREATED="1490523912790" ID="ID_423452442" MODIFIED="1490523916819" TEXT="spider_loader"/>
<node CREATED="1490523920254" ID="ID_1562202818" MODIFIED="1527144237755" TEXT="_crawlers"/>
<node CREATED="1527144239526" ID="ID_1358856914" MODIFIED="1527144242778" TEXT="_active"/>
</node>
</node>
<node CREATED="1490524309719" ID="ID_1503696557" MODIFIED="1527147131649" TEXT="methods">
<node CREATED="1490523844279" ID="ID_1551490849" MODIFIED="1490523846621" TEXT="crawl">
<node CREATED="1490524038607" ID="ID_1409977796" MODIFIED="1527144872890" TEXT="1.create_crawler =&gt; Crawler">
<arrowlink DESTINATION="ID_998778838" ENDARROW="Default" ENDINCLINATION="567;0;" ID="Arrow_ID_108875523" STARTARROW="None" STARTINCLINATION="567;0;"/>
</node>
<node CREATED="1490524178327" ID="ID_667013233" MODIFIED="1527144889713" TEXT="2. Crawler.crawl">
<arrowlink DESTINATION="ID_532501665" ENDARROW="Default" ENDINCLINATION="322;0;" ID="Arrow_ID_935458121" STARTARROW="None" STARTINCLINATION="322;0;"/>
</node>
</node>
<node CREATED="1490523847154" ID="ID_1922723574" MODIFIED="1490524817930" TEXT="start# twisted reactor start"/>
</node>
</node>
</node>
<node CREATED="1482239420753" ID="ID_998778838" MODIFIED="1527144872890" POSITION="right" TEXT="Crawler&#xff1a;&#x722c;&#x53d6;&#x4efb;&#x52a1;">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_998778838" ENDARROW="Default" ENDINCLINATION="567;0;" ID="Arrow_ID_108875523" SOURCE="ID_1409977796" STARTARROW="None" STARTINCLINATION="567;0;"/>
<node CREATED="1482240046109" ID="ID_1842921408" MODIFIED="1482240164154" TEXT="&#x901a;&#x8fc7;&#x6267;&#x884c;&#x5f15;&#x64ce;engine&#x5bf9;&#x8c61;&#x6765;&#x63a7;&#x5236;spider&#x7684;&#x6574;&#x4e2a;&#x751f;&#x547d;&#x5468;&#x671f;">
<arrowlink DESTINATION="ID_491732003" ENDARROW="Default" ENDINCLINATION="275;0;" ID="Arrow_ID_932641163" STARTARROW="None" STARTINCLINATION="275;0;"/>
</node>
<node CREATED="1490524355983" FOLDED="true" ID="ID_1745197386" MODIFIED="1527166649452" TEXT="members">
<node CREATED="1490524480391" ID="ID_571461802" MODIFIED="1490524484875" TEXT="properties">
<node CREATED="1527144990349" ID="ID_925070966" MODIFIED="1527145000752" TEXT="init">
<node CREATED="1527145004006" ID="ID_1280070459" MODIFIED="1527145014209" TEXT="spidercls"/>
<node CREATED="1527145015797" ID="ID_918403425" MODIFIED="1527145019345" TEXT="settings"/>
<node CREATED="1527145028180" ID="ID_1414814789" MODIFIED="1527145107426" TEXT="signals &lt;= &#x6d88;&#x606f;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x5185;&#x90e8;&#x6d88;&#x606f;&#x6d41;&#x8f6c;">
<node CREATED="1527145212478" ID="ID_857276977" MODIFIED="1527145216186" TEXT="&#x901a;&#x8fc7;connect&#x65b9;&#x6cd5;&#x6765;&#x6ce8;&#x518c;&#x5173;&#x5fc3;&#x6d88;&#x606f;&#x7684;&#x5904;&#x7406;&#x51fd;&#x6570;"/>
<node CREATED="1527145161230" ID="ID_918928068" MODIFIED="1527145224550" TEXT="&#x901a;&#x8fc7;send_catch_log_deferred&#x6765;&#x53d1;&#x9001;&#x6d88;&#x606f;"/>
</node>
<node CREATED="1527145046093" ID="ID_474583773" MODIFIED="1527145328820" TEXT="stats &#x900f;&#x4f20;&#x7ed9;&#x4e0d;&#x540c;&#x7ec4;&#x4ef6;&#xff0c;&#x5c5e;&#x6027;&#x5316;&#x5b9e;&#x73b0;&#x4fe1;&#x606f;&#x6536;&#x96c6;"/>
<node CREATED="1527145061941" ID="ID_1470164274" MODIFIED="1527145257403" TEXT="extensions &lt;= &#x57fa;&#x4e8e; signals &#x5b9e;&#x73b0; &#x9a71;&#x52a8;&#x6d41;&#x7a0b;"/>
</node>
<node CREATED="1490524456550" ID="ID_44879848" MODIFIED="1527146000816" TEXT="spider">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_44879848" ENDARROW="Default" ENDINCLINATION="244;0;" ID="Arrow_ID_1222158658" SOURCE="ID_1382471403" STARTARROW="None" STARTINCLINATION="244;0;"/>
</node>
<node CREATED="1490524364072" ID="ID_1586489188" MODIFIED="1527146009901" TEXT="engine">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1586489188" ENDARROW="Default" ENDINCLINATION="105;0;" ID="Arrow_ID_940496132" SOURCE="ID_1611960105" STARTARROW="None" STARTINCLINATION="105;0;"/>
</node>
</node>
<node CREATED="1490524492591" ID="ID_1937775111" MODIFIED="1527147127210" TEXT="methods">
<node CREATED="1490524496989" FOLDED="true" ID="ID_532501665" MODIFIED="1527166645954" TEXT="crawl">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_532501665" ENDARROW="Default" ENDINCLINATION="322;0;" ID="Arrow_ID_935458121" SOURCE="ID_667013233" STARTARROW="None" STARTINCLINATION="322;0;"/>
<node CREATED="1527145877324" ID="ID_1382471403" MODIFIED="1527146063705" TEXT="1._create_spider &lt;= spidercls.from_crawler">
<arrowlink DESTINATION="ID_44879848" ENDARROW="Default" ENDINCLINATION="244;0;" ID="Arrow_ID_1222158658" STARTARROW="None" STARTINCLINATION="244;0;"/>
</node>
<node CREATED="1527145946603" ID="ID_1611960105" MODIFIED="1527146329226" TEXT="2._create_engine &lt;= Engine.__init__(crawler)">
<arrowlink DESTINATION="ID_1586489188" ENDARROW="Default" ENDINCLINATION="105;0;" ID="Arrow_ID_940496132" STARTARROW="None" STARTINCLINATION="105;0;"/>
</node>
<node CREATED="1527146070940" ID="ID_1733899241" MODIFIED="1527146145240" TEXT="3.start_requests &lt;= spider.start_requests &#x52a0;&#x8f7d;spider&#x63d0;&#x4f9b;&#x7684;requests"/>
<node CREATED="1490524705030" ID="ID_707677894" MODIFIED="1527147172444" TEXT="4.engine.open_spider(start_requests,spider) &#x722c;&#x53d6;&#x51c6;&#x5907;&#x5de5;&#x4f5c;&#xff0c;&#x521d;&#x59cb;&#x5316;engine&#x5173;&#x952e;&#x7ec4;&#x4ef6;">
<arrowlink DESTINATION="ID_1932324776" ENDARROW="Default" ENDINCLINATION="884;0;" ID="Arrow_ID_833204636" STARTARROW="None" STARTINCLINATION="884;0;"/>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1482239423340" ID="ID_491732003" MODIFIED="1482240164154" POSITION="right" TEXT="ExecutionEngine">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_491732003" ENDARROW="Default" ENDINCLINATION="275;0;" ID="Arrow_ID_932641163" SOURCE="ID_1842921408" STARTARROW="None" STARTINCLINATION="275;0;"/>
<node CREATED="1482240081472" ID="ID_566260768" MODIFIED="1482240116961" TEXT="&#x6267;&#x884c;&#x5f15;&#x64ce;&#xff0c;&#x63a7;&#x5236;&#x6574;&#x4e2a;&#x8c03;&#x5ea6;&#x8fc7;&#x7a0b;"/>
<node CREATED="1482240092520" ID="ID_1265343808" MODIFIED="1482240146791" TEXT="&#x901a;&#x8fc7;twisted&#x7684;task.LoopingCall&#x6765;&#x4e0d;&#x65ad;&#x7684;&#x4ea7;&#x751f;&#x722c;&#x53d6;&#x4efb;&#x52a1;"/>
<node CREATED="1490524918082" ID="ID_781548955" MODIFIED="1527166884215" TEXT="members">
<node CREATED="1490524921456" ID="ID_863849816" MODIFIED="1490525248272" TEXT="properties">
<node CREATED="1527146448079" ID="ID_1229645731" MODIFIED="1527146451315" TEXT="init">
<node CREATED="1490524924863" ID="ID_1212278350" MODIFIED="1490524949012" TEXT="crawler"/>
<node CREATED="1527146463432" ID="ID_880241541" MODIFIED="1527146470276" TEXT="settings &lt;= crawler.settings"/>
<node CREATED="1527146470959" ID="ID_1911138138" MODIFIED="1527146480492" TEXT="signals &lt;= crawler.signals"/>
<node CREATED="1490524954311" ID="ID_556646295" MODIFIED="1527146610677" TEXT="scheduler_cls &lt;= settings"/>
<node CREATED="1527146571543" ID="ID_70679924" MODIFIED="1527146908770" TEXT="downloader &lt;= downloader_cls(crawler) &lt;= settings">
<arrowlink COLOR="#b0b0b0" DESTINATION="ID_831818606" ENDARROW="Default" ENDINCLINATION="657;45;" ID="Arrow_ID_479864909" STARTARROW="None" STARTINCLINATION="654;63;"/>
</node>
<node CREATED="1527146948908" ID="ID_788848899" MODIFIED="1527146958232" TEXT="scraper = Scraper(crawler)"/>
</node>
<node CREATED="1527148172620" ID="ID_73625336" MODIFIED="1527148175457" TEXT="scheduler"/>
<node CREATED="1490528933606" ID="ID_1017657990" MODIFIED="1490528999547" TEXT="inprocgress{&#x6b63;&#x5728;&#x5904;&#x7406;&#x7684;request}"/>
<node CREATED="1527166944726" ID="ID_556787248" MODIFIED="1527166967501" TEXT="slot">
<arrowlink DESTINATION="ID_1755135578" ENDARROW="Default" ENDINCLINATION="482;0;" ID="Arrow_ID_1794673112" STARTARROW="None" STARTINCLINATION="482;0;"/>
</node>
<node CREATED="1490524949454" ID="ID_1832611577" MODIFIED="1490524953995" TEXT="spider"/>
</node>
<node CREATED="1490525013127" ID="ID_1217658870" MODIFIED="1527168013632" TEXT="methods">
<node CREATED="1490525087715" ID="ID_1932324776" MODIFIED="1527147172444" TEXT="open_spider">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1932324776" ENDARROW="Default" ENDINCLINATION="884;0;" ID="Arrow_ID_833204636" SOURCE="ID_707677894" STARTARROW="None" STARTINCLINATION="884;0;"/>
<node CREATED="1527149617183" ID="ID_846996628" MODIFIED="1527167225505" STYLE="fork" TEXT="1.nextcall = CallLaterOnce(self._next_request, spider)  &#x5c01;&#x88c5;engine&#x5904;&#x7406;reqeust&#x6267;&#x884c;&#x4f53;">
<arrowlink DESTINATION="ID_577053759" ENDARROW="Default" ENDINCLINATION="171;-73;" ID="Arrow_ID_633973574" STARTARROW="None" STARTINCLINATION="240;-42;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_846996628" ENDARROW="Default" ENDINCLINATION="492;0;" ID="Arrow_ID_1804835201" SOURCE="ID_8880734" STARTARROW="None" STARTINCLINATION="492;0;"/>
<node CREATED="1527167283143" ID="ID_1240745872" MODIFIED="1527167548105" TEXT="schedule &lt;= nextcall.schedule ## &#x6267;&#x884c;engine._next_request"/>
</node>
<node CREATED="1527148149789" ID="ID_1177622582" MODIFIED="1527149640090" TEXT="2.scheduler  &lt;= scheduler_cls.from_crawler(crawler)"/>
<node CREATED="1527148409638" ID="ID_1489473701" MODIFIED="1527166879070" TEXT="3.slot = Slot(start_requests, close_if_idle, nextcall, scheduler)">
<arrowlink COLOR="#b0b0b0" DESTINATION="ID_1755135578" ENDARROW="Default" ENDINCLINATION="379;0;" ID="Arrow_ID_1703706745" STARTARROW="None" STARTINCLINATION="379;0;"/>
</node>
<node CREATED="1490525962592" ID="ID_530213195" MODIFIED="1527149650322" TEXT="4.scheduler.open(spider)&#xff0c;scraper.open_spider(spider)&#xff0c;crawler.stats.open_spider(spider)&#x7b49;&#x7ec4;&#x4ef6;&#x524d;&#x7f6e;&#x5904;&#x7406;"/>
<node CREATED="1490525992583" ID="ID_1776175718" MODIFIED="1527149655411" TEXT="5.slot.nextcall.schedule &#x624b;&#x52a8;&#x89e6;&#x53d1;&#x6d41;&#x7a0b;"/>
<node CREATED="1490526011137" ID="ID_1888702260" MODIFIED="1527149660467" TEXT="6.slot.heartbeart.start(5) &#x5468;&#x671f;&#x6027;&#x89e6;&#x53d1;&#x6d41;&#x7a0b;"/>
</node>
<node CREATED="1527151287181" ID="ID_577053759" MODIFIED="1527168132225" TEXT="_next_quest(spider) &#x722c;&#x53d6;&#x64cd;&#x4f5c;&#x4e3b;&#x4f53;&#x6d41;&#x7a0b;">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_577053759" ENDARROW="Default" ENDINCLINATION="171;-73;" ID="Arrow_ID_633973574" SOURCE="ID_846996628" STARTARROW="None" STARTINCLINATION="240;-42;"/>
<icon BUILTIN="messagebox_warning"/>
<node CREATED="1527151365620" ID="ID_632549064" MODIFIED="1527151933396" TEXT="_next_request_from_scheduler(spider) &#x901a;&#x8fc7;scheduler&#x83b7;&#x53d6;request">
<node CREATED="1527151368635" ID="ID_1222893057" MODIFIED="1527151947548" TEXT="_download(request, spider)">
<node CREATED="1527151974904" ID="ID_466565099" MODIFIED="1527152416679" TEXT="downloader.fetch(request, spider)">
<arrowlink DESTINATION="ID_1997249837" ENDARROW="Default" ENDINCLINATION="931;0;" ID="Arrow_ID_164069088" STARTARROW="None" STARTINCLINATION="931;0;"/>
</node>
</node>
<node CREATED="1527151995713" ID="ID_1297644873" MODIFIED="1527152004764" TEXT="_handle_downloader_output(request, spider)">
<node CREATED="1527152050448" ID="ID_477843596" MODIFIED="1527152098917" TEXT="request =&gt; crawl(response, spider) &#x52a0;&#x961f;&#x5217;"/>
<node CREATED="1527152056024" ID="ID_1848022076" MODIFIED="1527152117533" TEXT="response =&gt; scraper.enqueue_scrape(response, request, spider) &#x8fdb;&#x5165;scraper &#x5904;&#x7406;&#x6d41;&#x7a0b;"/>
</node>
</node>
<node CREATED="1527151749413" ID="ID_646498693" MODIFIED="1527151881916" TEXT="request = next(slot.start_requests) =&gt; crawl(request, spider) &#x628a;spider&#x521d;&#x59cb;&#x5316;requests&#x52a0;&#x5165;&#x961f;&#x5217;"/>
<node CREATED="1527171823114" ID="ID_1566192463" MODIFIED="1527172043727" TEXT="spider_is_idle ## spider&#x662f;&#x5426;&#x7a7a;&#x95f2;&#xff0c;&#x662f;&#x5426;&#x80fd;close"/>
<node CREATED="1482242843832" ID="ID_1020454108" MODIFIED="1482242852423" TEXT="&#x6838;&#x5fc3;&#x6d41;&#x7a0b;">
<node CREATED="1482242853444" ID="ID_1942488620" MODIFIED="1527151363186" TEXT="1.&#x4ece;&#x961f;&#x5217;&#x4e2d;&#x83b7;&#x53d6;request">
<arrowlink COLOR="#b0b0b0" DESTINATION="ID_1593561217" ENDARROW="Default" ENDINCLINATION="53;-141;" ID="Arrow_ID_1555440781" STARTARROW="None" STARTINCLINATION="-139;55;"/>
</node>
<node CREATED="1482242886505" ID="ID_1321393459" MODIFIED="1527167977227" TEXT="2.&#x5982;&#x679c;&#x961f;&#x5217;&#x4e2d;&#x65e0;request&#xff0c;&#x4ece;start_requests&#x4e2d;&#x83b7;&#x53d6;&#xff0c;&#x5e76;&#x901a;&#x8fc7;crawl&#x52a0;&#x5165;&#x961f;&#x5217;"/>
<node CREATED="1482243053358" ID="ID_1502230018" MODIFIED="1482243420667" TEXT="3.spider&#x7a7a;&#x95f2;&#xff0c;&#x5173;&#x95ed;&#x5e76;&#x7ed3;&#x675f;&#xff1b;&#x7a7a;&#x95f2;&#x6761;&#x4ef6;&#x5224;&#x65ad;">
<node CREATED="1482243167946" ID="ID_738269621" MODIFIED="1482243248673" TEXT="&#x6ca1;&#x6709;&#x4efb;&#x4f55;&#x4e0b;&#x8f7d;&#x4efb;&#x52a1;"/>
<node CREATED="1482243265188" ID="ID_708578172" MODIFIED="1482243270425" TEXT="&#x6ca1;&#x6709;&#x4efb;&#x4f55;&#x6570;&#x636e;&#x5904;&#x7406;&#x4efb;&#x52a1;"/>
<node CREATED="1482243284817" ID="ID_845722555" MODIFIED="1482243299783" TEXT="&#x6ca1;&#x6709;start_requests"/>
<node CREATED="1482243293857" ID="ID_790982295" MODIFIED="1482243296411" TEXT="&#x6ca1;&#x6709;&#x963b;&#x585e;&#x7684;requests"/>
</node>
</node>
</node>
<node CREATED="1527151775766" ID="ID_437978424" MODIFIED="1527168046546" TEXT="crawl(request, spider)">
<node CREATED="1527168048608" ID="ID_1858742295" MODIFIED="1527168055291" TEXT=" schedule(request, spider) &#x628a;&#x8bf7;&#x6c42;&#x901a;&#x8fc7;&#x8c03;&#x5ea6;&#x5668;&#x52a0;&#x5165;&#x961f;&#x5217;"/>
<node CREATED="1527168021787" ID="ID_1386144407" MODIFIED="1527168084403" TEXT="slot.nextcall.schedule() &#x6267;&#x884c;&#x4e00;&#x6b21;&#x722c;&#x53d6;&#x64cd;&#x4f5c;"/>
</node>
</node>
</node>
<node CREATED="1527149131372" ID="ID_1473920919" MODIFIED="1527149137374" TEXT="&#x7ec4;&#x4ef6;">
<node CREATED="1527146780777" FOLDED="true" ID="ID_424455011" MODIFIED="1527166614556" TEXT="Downloader">
<node CREATED="1527146785242" ID="ID_1327654145" MODIFIED="1527146789694" TEXT="properties">
<node CREATED="1527146790699" ID="ID_831818606" MODIFIED="1527146908771" TEXT="init">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_831818606" ENDARROW="Default" ENDINCLINATION="657;45;" ID="Arrow_ID_479864909" SOURCE="ID_70679924" STARTARROW="None" STARTINCLINATION="654;63;"/>
<node CREATED="1527146794251" ID="ID_151553114" MODIFIED="1527146812590" TEXT="settings &lt;= crawler.settings"/>
<node CREATED="1527146814633" ID="ID_23234392" MODIFIED="1527146828440" TEXT="signals &lt;= crawler.signals"/>
<node CREATED="1527146829362" ID="ID_1379298344" MODIFIED="1527149102799" TEXT="handers = DownloadHandlers(crawler)  &#x8bf7;&#x6c42;&#x5904;&#x7406;"/>
<node CREATED="1527146838946" ID="ID_1988128032" MODIFIED="1527153965403" TEXT="middleware  = DownloaderMiddlewareManager.from_crawler(crawler)  &#x4e2d;&#x95f4;&#x4ef6;&#x5bb9;&#x5668;"/>
</node>
<node CREATED="1527154458115" ID="ID_129815551" MODIFIED="1527154589849" TEXT="slot">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_129815551" ENDARROW="Default" ENDINCLINATION="294;-35;" ID="Arrow_ID_1674351880" SOURCE="ID_1844763538" STARTARROW="None" STARTINCLINATION="-227;-13;"/>
</node>
</node>
<node CREATED="1527147093005" ID="ID_154639824" MODIFIED="1527147097680" TEXT="methods">
<node CREATED="1527152387682" ID="ID_1997249837" MODIFIED="1527152416679" TEXT="fetch">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1997249837" ENDARROW="Default" ENDINCLINATION="931;0;" ID="Arrow_ID_164069088" SOURCE="ID_466565099" STARTARROW="None" STARTINCLINATION="931;0;"/>
<node CREATED="1527152419243" ID="ID_1424564012" MODIFIED="1527153358295" TEXT="middleware.download(self._enqueue_request, request, spider) ">
<node CREATED="1527153330617" ID="ID_1894062214" MODIFIED="1527153331742" TEXT="process_request">
<node CREATED="1527153361805" ID="ID_1895784375" MODIFIED="1527164452752" TEXT="(yield download_func(request=request,spider=spider)) =&gt; &#x56de;&#x8c03;_enqueue_request">
<arrowlink DESTINATION="ID_1844763538" ENDARROW="Default" ENDINCLINATION="313;-15;" ID="Arrow_ID_342494807" STARTARROW="None" STARTINCLINATION="-259;-60;"/>
</node>
</node>
<node CREATED="1527153336666" ID="ID_145496509" MODIFIED="1527153337405" TEXT="process_response"/>
<node CREATED="1527153350809" ID="ID_1348538475" MODIFIED="1527153352071" TEXT="process_exception"/>
</node>
</node>
<node CREATED="1527152442667" ID="ID_1844763538" MODIFIED="1527164452753" TEXT="_enqueue_quest(request,spider)  [Downloader.Slot.init]&#x8bf7;&#x6c42;&#x5904;&#x7406;&#x6d41;&#x7a0b;&#xff0c;&#x5148;&#x5165;&#x961f;&#xff0c;&#x518d;&#x51fa;&#x961f;&#xff0c;&#x518d;&#x6267;&#x884c;reqeust&#x8bf7;&#x6c42;">
<arrowlink DESTINATION="ID_129815551" ENDARROW="Default" ENDINCLINATION="294;-35;" ID="Arrow_ID_1674351880" STARTARROW="None" STARTINCLINATION="-227;-13;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1844763538" ENDARROW="Default" ENDINCLINATION="313;-15;" ID="Arrow_ID_342494807" SOURCE="ID_1895784375" STARTARROW="None" STARTINCLINATION="-259;-60;"/>
<node CREATED="1527152808237" ID="ID_63720933" MODIFIED="1527153003643" TEXT="1.slot.queue.append((request, deferred)) &#x6267;&#x884c;&#x4f53;&#x5165;&#x961f;"/>
<node CREATED="1527152791894" ID="ID_1507978838" MODIFIED="1527153173221" TEXT="2._process_queue(spider, slot) &#x6267;&#x884c;&#x4f53;&#x51fa;&#x961f;&#x5904;&#x7406;(while)">
<node CREATED="1527152854265" ID="ID_1782440664" MODIFIED="1527152855522" TEXT="_download(slot, request, spider)">
<node CREATED="1527152876429" ID="ID_634825043" MODIFIED="1527153140533" TEXT="handlers.download_request(request, spider) &#x5904;&#x7406;&#x8bf7;&#x6c42;"/>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1527148983275" FOLDED="true" ID="ID_142943532" MODIFIED="1527166612710" TEXT="Scraper">
<node CREATED="1527153884487" ID="ID_531784373" MODIFIED="1527153896648" TEXT="properties">
<node CREATED="1527153896648" ID="ID_671520544" MODIFIED="1527153899815" TEXT="init">
<node CREATED="1527153899815" ID="ID_824485531" MODIFIED="1527153974035" TEXT="spidermw = SpiderMiddlewareManager.from_crawler(crawler) &#x4e2d;&#x95f4;&#x4ef6;&#x5bb9;&#x5668;"/>
<node CREATED="1527153927743" ID="ID_176538594" MODIFIED="1527165589576" TEXT="itemproc = itemproc_cls.from_crawler(crawler) &lt;= settings[&apos;scrapy.pipelines.ItemPipelineManager&apos;] &#x4e2d;&#x95f4;&#x4ef6;">
<node CREATED="1527154306844" ID="ID_421120612" MODIFIED="1527154308379" TEXT="ITEM_PIPELINES"/>
</node>
<node CREATED="1527153999176" ID="ID_55924191" MODIFIED="1527154020402" TEXT="crawler = crawler "/>
<node CREATED="1527154005247" ID="ID_1598878916" MODIFIED="1527154012298" TEXT="signals = crawler.signals "/>
</node>
<node CREATED="1527154444733" ID="ID_641358003" MODIFIED="1527155172635" TEXT="slot">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_641358003" ENDARROW="Default" ENDINCLINATION="140;0;" ID="Arrow_ID_1781095750" SOURCE="ID_958119650" STARTARROW="None" STARTINCLINATION="140;0;"/>
</node>
</node>
<node CREATED="1527154436667" ID="ID_502951119" MODIFIED="1527154441314" TEXT="methods">
<node CREATED="1527155138580" ID="ID_958119650" MODIFIED="1527155172635" TEXT="open_spider(spider) =&gt;  Slot()">
<arrowlink DESTINATION="ID_641358003" ENDARROW="Default" ENDINCLINATION="140;0;" ID="Arrow_ID_1781095750" STARTARROW="None" STARTINCLINATION="140;0;"/>
</node>
<node CREATED="1527155188095" ID="ID_1900926161" MODIFIED="1527155199651" TEXT="enqueue_scrape(response, request, spider)">
<node CREATED="1527155294929" ID="ID_1594862530" MODIFIED="1527155308496" TEXT="1.slot.add_response_request(response, request)"/>
<node CREATED="1527155318240" ID="ID_414337820" MODIFIED="1527155320700" TEXT="2._scrape_next(spider, slot)">
<node CREATED="1527155344056" ID="ID_1990125890" MODIFIED="1527155377766" TEXT="1.response, request, deferred = slot.next_response_request_deferred()"/>
<node CREATED="1527155359008" ID="ID_1172860197" MODIFIED="1527155367189" TEXT="2._scrape(response, request, spider)">
<node CREATED="1527155404737" ID="ID_1845594152" MODIFIED="1527164472897" TEXT="_scrape2(response, request, spider) ">
<node CREATED="1527163390158" ID="ID_1575542974" MODIFIED="1527164749834" TEXT="spidermw.scrape_response(self.call_spider, request_result, request, spider) ">
<node CREATED="1527164503740" ID="ID_55432010" MODIFIED="1527164514893" TEXT="process_spider_input">
<node CREATED="1527164576435" ID="ID_1068117551" MODIFIED="1527164760672" TEXT="scrape_func(response, request, spider">
<arrowlink DESTINATION="ID_1797630501" ENDARROW="Default" ENDINCLINATION="1518;0;" ID="Arrow_ID_1899275195" STARTARROW="None" STARTINCLINATION="1518;0;"/>
</node>
</node>
<node CREATED="1527164519928" ID="ID_1238725006" MODIFIED="1527164521428" TEXT="process_spider_exception"/>
<node CREATED="1527164527234" ID="ID_730569253" MODIFIED="1527164528445" TEXT="process_spider_output"/>
</node>
</node>
<node CREATED="1527163802511" ID="ID_921345277" MODIFIED="1527165239557" STYLE="fork" TEXT="=&gt; handle_spider_output(request, response, spider)  ## _scrape2&#x7684;&#x56de;&#x8c03;&#xff0c;&#x5904;&#x7406;&#x5176;&#x8f93;&#x51fa;{Item,Request,None}">
<arrowlink COLOR="#b0b0b0" DESTINATION="ID_1605353440" ENDARROW="Default" ENDINCLINATION="38;8;" ID="Arrow_ID_508906067" STARTARROW="None" STARTINCLINATION="-91;141;"/>
</node>
</node>
</node>
</node>
<node CREATED="1527163495302" ID="ID_1797630501" MODIFIED="1527164760671" TEXT="call_spider(request_result, request, spider) ">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1797630501" ENDARROW="Default" ENDINCLINATION="1518;0;" ID="Arrow_ID_1899275195" SOURCE="ID_1068117551" STARTARROW="None" STARTINCLINATION="1518;0;"/>
<node CREATED="1527163562119" ID="ID_74429945" MODIFIED="1527164296156" TEXT=" dfd.addCallbacks(request.callback or spider.parse, request.errback) ## &#x5904;&#x7406;&#x8f93;&#x5165;request_result "/>
<node CREATED="1527163588086" ID="ID_775982771" MODIFIED="1527164321965" TEXT="dfd.addCallback(iterate_spider_output) ## spider&#x8f93;&#x51fa;{Item&#xff0c;Request&#xff0c;None}"/>
</node>
<node CREATED="1527163659823" ID="ID_1605353440" MODIFIED="1527165239557" STYLE="fork" TEXT="handle_spider_output(request, response, spider) ">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1605353440" ENDARROW="Default" ENDINCLINATION="38;8;" ID="Arrow_ID_508906067" SOURCE="ID_921345277" STARTARROW="None" STARTINCLINATION="-91;141;"/>
<node CREATED="1527165194445" ID="ID_517611505" MODIFIED="1527165219224" TEXT="_process_spidermw_output( request, response, spider)">
<node CREATED="1527165244208" ID="ID_820995404" MODIFIED="1527165339353" TEXT="Request =&gt; crawler.engine.crawl(request=output, spider=spider) # Request &#x8fdb;&#x961f;&#x5217;"/>
<node CREATED="1527165282164" ID="ID_871128559" MODIFIED="1527165618313" TEXT="Item or dict =&gt; itemproc.process_item(output, spider) # ItemPipeline &#x4e2d;&#x95f4;&#x4ef6;"/>
</node>
</node>
</node>
</node>
<node CREATED="1527153199394" ID="ID_751137354" MODIFIED="1527153223605" TEXT="Slot&#x5bb9;&#x5668;">
<node CREATED="1527149161267" ID="ID_413907873" MODIFIED="1527166960592" TEXT="engine.Slot">
<node CREATED="1527149251703" ID="ID_1232135130" MODIFIED="1527149255527" TEXT="properties">
<node CREATED="1527149256404" ID="ID_1755135578" MODIFIED="1527166967501" TEXT="init">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1755135578" ENDARROW="Default" ENDINCLINATION="379;0;" ID="Arrow_ID_1703706745" SOURCE="ID_1489473701" STARTARROW="None" STARTINCLINATION="379;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1755135578" ENDARROW="Default" ENDINCLINATION="482;0;" ID="Arrow_ID_1794673112" SOURCE="ID_556787248" STARTARROW="None" STARTINCLINATION="482;0;"/>
<node CREATED="1527149260061" ID="ID_144703742" MODIFIED="1527149327568" TEXT="inprogress &#x6b63;&#x5728;&#x5904;&#x7406;&#x8bf7;&#x6c42;"/>
<node CREATED="1527149274123" ID="ID_1955784042" MODIFIED="1527149356888" TEXT="start_requests &lt;= spider.start_requests &#x900f;&#x4f20;&#x7684;&#x521d;&#x59cb;&#x5316;&#x8bf7;&#x6c42;"/>
<node CREATED="1527149284676" ID="ID_8880734" MODIFIED="1527167246636" TEXT="nextcall">
<arrowlink DESTINATION="ID_846996628" ENDARROW="Default" ENDINCLINATION="492;0;" ID="Arrow_ID_1804835201" STARTARROW="None" STARTINCLINATION="492;0;"/>
</node>
<node CREATED="1527149288875" ID="ID_1747508927" MODIFIED="1527167004455" TEXT="scheduler &lt;= engine.scheduler"/>
<node CREATED="1527149293339" ID="ID_1831739190" MODIFIED="1527149469658" TEXT="heartbeat &lt;= task.LoopingCall(nextcall.schedule) &#x5c01;&#x88c5;&#x5468;&#x671f;&#x6267;&#x884c;"/>
</node>
</node>
</node>
<node CREATED="1527149217731" ID="ID_543566641" MODIFIED="1527149226472" TEXT="downloader.Slot">
<node CREATED="1527152583599" ID="ID_1806973791" MODIFIED="1527152588905" TEXT="properties">
<node CREATED="1527152589821" ID="ID_557238782" MODIFIED="1527152591265" TEXT="init">
<node CREATED="1527152592006" ID="ID_811307385" MODIFIED="1527152600929" TEXT="concurrency"/>
<node CREATED="1527152601156" ID="ID_1794379933" MODIFIED="1527152603593" TEXT="delay"/>
<node CREATED="1527152607420" ID="ID_465796651" MODIFIED="1527152614625" TEXT="randomize_delay"/>
<node CREATED="1527152619108" ID="ID_409062794" MODIFIED="1527152923427" TEXT="active  =&gt; requests"/>
<node CREATED="1527152626094" ID="ID_978704746" MODIFIED="1527152984291" TEXT="queue =&gt; request&#x5904;&#x7406;&#x6267;&#x884c;&#x4f53;&#x961f;&#x5217;"/>
</node>
</node>
</node>
</node>
</node>
</node>
<node CREATED="1527167648726" ID="ID_865314600" MODIFIED="1527167651970" POSITION="right" TEXT="&#x5176;&#x4ed6;">
<node CREATED="1527145713298" ID="ID_446561104" MODIFIED="1527145862086" TEXT="cls.__init__ =&gt; cls.from_crawler [ =&gt; cls.from_settings ]"/>
<node CREATED="1482243513711" ID="ID_1593561217" MODIFIED="1527167604081" TEXT="request&#x751f;&#x547d;&#x5468;&#x671f;&#x4ee5;&#x53ca;&#x6838;&#x5fc3;&#x6d41;&#x7a0b;">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1593561217" ENDARROW="Default" ENDINCLINATION="53;-141;" ID="Arrow_ID_1555440781" SOURCE="ID_1942488620" STARTARROW="None" STARTINCLINATION="-139;55;"/>
<node CREATED="1482244567685" ID="ID_600284521" MODIFIED="1482288243650" TEXT="1.start_urls -&gt; start_requests -&gt; queue -&gt; url">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_600284521" ENDARROW="Default" ENDINCLINATION="231;0;" ID="Arrow_ID_528567190" SOURCE="ID_1286188689" STARTARROW="None" STARTINCLINATION="231;0;"/>
</node>
<node CREATED="1482287907822" ID="ID_1750676710" MODIFIED="1482288248614" TEXT="2.downloader - &gt; response"/>
<node CREATED="1482288103401" ID="ID_1402954565" MODIFIED="1482306230028" TEXT="3.scraper -&gt; request.callback | spider.parse - &gt; request | item,dict">
<node CREATED="1482288395084" ID="ID_1294507714" MODIFIED="1482304914171" TEXT="scraper._process_spidermw_output()#handle spider.parse return object"/>
<node CREATED="1482288213106" ID="ID_1286188689" MODIFIED="1482304906538" TEXT="request&#xff1a;enqueue#self.crawler.engine.crawl()">
<arrowlink COLOR="#b0b0b0" DESTINATION="ID_600284521" ENDARROW="Default" ENDINCLINATION="231;0;" ID="Arrow_ID_528567190" STARTARROW="None" STARTINCLINATION="231;0;"/>
</node>
<node CREATED="1482288215454" ID="ID_342768296" MODIFIED="1482306237004" TEXT="item,dict#self.itemproc.process_item()">
<arrowlink COLOR="#b0b0b0" DESTINATION="ID_1442623525" ENDARROW="Default" ENDINCLINATION="312;0;" ID="Arrow_ID_1692806389" STARTARROW="None" STARTINCLINATION="312;0;"/>
</node>
</node>
<node CREATED="1482288261272" ID="ID_1442623525" MODIFIED="1482288276094" TEXT="4.itempipeline">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1442623525" ENDARROW="Default" ENDINCLINATION="312;0;" ID="Arrow_ID_1692806389" SOURCE="ID_342768296" STARTARROW="None" STARTINCLINATION="312;0;"/>
</node>
</node>
</node>
</node>
</map>
